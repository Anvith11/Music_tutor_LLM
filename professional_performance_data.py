#!/usr/bin/env python3
"""
Professional Performance Knowledge - Fourth Pillar
Original content inspired by professional guitar education methodologies
Covers advanced performance, ear training, voicings, and live techniques
"""

# Professional Performance Knowledge Structure
PROFESSIONAL_PERFORMANCE_KNOWLEDGE = {
    "advanced_nashville_applications": {
        "description": "Professional Nashville Number System applications in real-world contexts",
        "concepts": {
            "live_performance": {
                "key_change_communication": "Hand signals and verbal cues for last-minute key changes",
                "chart_reading": "Quick chart interpretation during live performance",
                "progression_calling": "Real-time progression communication with band members",
                "tempo_changes": "Communicating tempo shifts using Nashville notation",
                "modulation_techniques": "Professional modulation and key center changes"
            },
            "studio_applications": {
                "session_communication": "Professional studio chart reading and notation",
                "producer_language": "Communicating musical ideas with producers and engineers",
                "arrangement_notation": "Using Nashville numbers for arrangement discussions",
                "overdub_coordination": "Coordinating multiple instrument parts using number system",
                "demo_creation": "Quick demo creation using Nashville number shortcuts"
            },
            "advanced_patterns": {
                "modal_applications": "Nashville numbers in modal contexts and borrowed chords",
                "complex_progressions": "Advanced progressions beyond basic triadic patterns",
                "rhythmic_notation": "Incorporating rhythmic elements into Nashville charts",
                "dynamic_markings": "Adding dynamics and articulation to number charts",
                "form_notation": "Song form and structure notation using Nashville system"
            }
        }
    },
    
    "professional_ear_training": {
        "description": "Industry-standard ear training and transcription methodologies",
        "concepts": {
            "transcription_techniques": {
                "melody_transcription": "Step-by-step methodology for accurate melody transcription",
                "chord_progression_analysis": "Hearing and notating complex chord progressions",
                "bass_line_transcription": "Identifying bass movement and chord inversions",
                "rhythm_transcription": "Accurate rhythmic notation and syncopation",
                "solo_transcription": "Professional techniques for solo and improvisation transcription"
            },
            "interval_mastery": {
                "melodic_intervals": "Precise identification of melodic interval relationships",
                "harmonic_intervals": "Simultaneous interval recognition in chord contexts",
                "compound_intervals": "Recognition of intervals beyond the octave",
                "microtonal_awareness": "Subtle pitch relationships and intonation",
                "contextual_intervals": "Interval recognition within musical contexts"
            },
            "chord_recognition": {
                "triad_identification": "Rapid major, minor, diminished, augmented recognition",
                "seventh_chord_types": "All seventh chord qualities and inversions",
                "extended_chords": "9th, 11th, 13th chord recognition and analysis",
                "altered_chords": "Chromatic alterations and substitute chord recognition",
                "voicing_analysis": "Identifying specific chord voicings and inversions"
            },
            "real_time_analysis": {
                "harmonic_rhythm": "Identifying chord change timing and patterns",
                "key_center_identification": "Quick key recognition and modulation detection",
                "form_analysis": "Real-time song form and structure analysis",
                "style_recognition": "Genre-specific harmonic and rhythmic patterns",
                "performance_analysis": "Analyzing live performance techniques by ear"
            }
        }
    },
    
    "advanced_chord_voicings": {
        "description": "Professional chord voicing techniques and creative applications",
        "concepts": {
            "jazz_voicings": {
                "rootless_voicings": "Professional rootless chord voicings for comping",
                "shell_voicings": "Essential 3rd and 7th voicings for accompaniment",
                "upper_structure_triads": "Advanced upper structure chord techniques",
                "quartal_voicings": "Fourth-based chord voicings and applications",
                "cluster_voicings": "Dissonant cluster chords and resolution techniques"
            },
            "contemporary_voicings": {
                "pop_chord_colors": "Modern pop and rock chord voicing techniques",
                "worship_voicings": "Contemporary worship and gospel chord applications",
                "indie_sounds": "Alternative and indie rock chord voicing approaches",
                "r_and_b_chords": "Soul, R&B, and neo-soul chord voicing styles",
                "electronic_adaptations": "Chord voicings adapted for electronic music contexts"
            },
            "capo_techniques": {
                "creative_capo_usage": "Using capo for unique chord voicings and colors",
                "partial_capo_techniques": "Advanced partial capo applications",
                "capo_transposition": "Strategic capo placement for optimal voicings",
                "capo_arrangement": "Arrangement techniques utilizing capo positioning",
                "capo_tone_shaping": "Using capo for tonal and textural variations"
            },
            "neck_position_mastery": {
                "chord_inversions_across_neck": "Playing same chord in multiple neck positions",
                "voice_leading_techniques": "Smooth voice leading between chord positions",
                "position_specific_voicings": "Voicings optimized for specific neck positions",
                "fingering_optimization": "Efficient fingering patterns for complex voicings",
                "neck_visualization": "Complete fretboard visualization for chord work"
            }
        }
    },
    
    "creative_performance_techniques": {
        "description": "Professional performance skills and creative musical expression",
        "concepts": {
            "improvisation_strategies": {
                "melodic_development": "Professional melodic improvisation techniques",
                "rhythmic_displacement": "Advanced rhythmic variation and displacement",
                "motivic_development": "Developing musical motifs through improvisation",
                "call_and_response": "Interactive improvisation and musical conversation",
                "stylistic_improvisation": "Genre-specific improvisation approaches"
            },
            "arrangement_techniques": {
                "instrument_arrangement": "Professional multi-instrument arrangement skills",
                "texture_management": "Creating and managing musical textures",
                "dynamic_arrangement": "Using dynamics for musical impact",
                "sectional_arrangement": "Arranging for different musical sections",
                "orchestration_principles": "Basic orchestration for popular music"
            },
            "live_performance_skills": {
                "stage_presence": "Professional stage presence and audience engagement",
                "performance_preparation": "Systematic preparation for live performance",
                "mistake_recovery": "Professional recovery from performance errors",
                "equipment_management": "Live equipment setup and troubleshooting",
                "band_communication": "Non-verbal communication during performance"
            },
            "creative_expression": {
                "personal_style_development": "Developing individual musical voice",
                "genre_fusion": "Creatively combining different musical styles",
                "experimental_techniques": "Exploring unconventional playing approaches",
                "composition_integration": "Integrating compositional elements into performance",
                "interpretive_skills": "Personal interpretation of existing music"
            }
        }
    },
    
    "tone_and_production_mastery": {
        "description": "Professional tone shaping, effects usage, and production techniques",
        "concepts": {
            "signal_chain_optimization": {
                "signal_flow_fundamentals": "Understanding audio signal flow and optimization",
                "impedance_matching": "Proper impedance relationships in signal chain",
                "gain_staging": "Professional gain staging throughout signal chain",
                "noise_management": "Minimizing noise and interference in signal path",
                "buffer_placement": "Strategic buffer placement for signal integrity"
            },
            "effects_mastery": {
                "modulation_effects": "Professional use of chorus, flanger, phaser, tremolo",
                "time_based_effects": "Delay and reverb techniques for musical enhancement",
                "distortion_techniques": "Overdrive, distortion, and fuzz applications",
                "filter_effects": "Wah, envelope filters, and EQ for tonal shaping",
                "creative_effects_usage": "Unconventional and creative effects applications"
            },
            "recording_techniques": {
                "microphone_selection": "Choosing appropriate microphones for different sources",
                "mic_placement": "Professional microphone placement techniques",
                "direct_recording": "DI recording techniques and signal processing",
                "ambient_recording": "Room tone and ambient recording techniques",
                "multi_tracking": "Professional multi-track recording approaches"
            },
            "live_sound_management": {
                "monitor_mixing": "Personal monitor mixing and feedback management",
                "venue_adaptation": "Adapting tone and setup to different venues",
                "troubleshooting": "Quick diagnosis and resolution of sound issues",
                "sound_check_efficiency": "Efficient sound check procedures",
                "wireless_systems": "Professional wireless guitar system usage"
            }
        }
    }
}

# Enhanced keywords for professional performance detection
PROFESSIONAL_PERFORMANCE_KEYWORDS = {
    "advanced_nashville": [
        "key changes", "chart reading", "progression calling", "studio communication",
        "session work", "producer language", "arrangement notation", "demo creation",
        "modal nashville", "complex progressions", "form notation", "tempo changes"
    ],
    
    "ear_training": [
        "transcription", "melody transcription", "chord transcription", "bass transcription",
        "solo transcription", "by ear", "interval recognition", "chord recognition",
        "harmonic analysis", "rhythm transcription", "real time analysis", "key identification"
    ],
    
    "advanced_voicings": [
        "chord voicings", "jazz voicings", "rootless voicings", "shell voicings",
        "upper structure", "quartal voicings", "contemporary voicings", "capo techniques",
        "partial capo", "neck positions", "voice leading", "chord inversions",
        "fingering patterns", "position playing"
    ],
    
    "performance": [
        "improvisation", "melodic development", "rhythmic displacement", "motivic development",
        "arrangement techniques", "live performance", "stage presence", "performance preparation",
        "mistake recovery", "band communication", "creative expression", "personal style"
    ],
    
    "tone_production": [
        "signal chain", "signal flow", "impedance matching", "gain staging",
        "effects usage", "modulation effects", "time based effects", "distortion techniques",
        "recording techniques", "microphone placement", "direct recording", "live sound",
        "monitor mixing", "sound check", "wireless systems", "troubleshooting"
    ]
}

# Professional performance methodologies
PERFORMANCE_METHODOLOGIES = {
    "transcription_process": {
        "step_1": "Listen for overall form and key center",
        "step_2": "Identify chord progression and harmonic rhythm", 
        "step_3": "Transcribe bass line and chord voicings",
        "step_4": "Notate melody and rhythmic elements",
        "step_5": "Add performance details and articulations"
    },
    
    "ear_training_progression": {
        "beginner": "Simple intervals, major/minor triads, basic progressions",
        "intermediate": "Seventh chords, modal scales, more complex progressions",
        "advanced": "Extended chords, altered harmonies, rapid transcription",
        "professional": "Real-time analysis, complex jazz harmonies, microtonal awareness"
    },
    
    "voicing_development": {
        "foundation": "Basic open and barre chord shapes",
        "expansion": "Chord inversions and alternate positions",
        "sophistication": "Jazz voicings and extended harmonies",
        "mastery": "Creative voicings and personal style development"
    }
}

# Get all professional performance keywords
def get_professional_performance_keywords():
    """Return all professional performance keywords for enhanced detection"""
    all_keywords = set()
    for category in PROFESSIONAL_PERFORMANCE_KEYWORDS.values():
        all_keywords.update(category)
    return all_keywords

# Check if text contains professional performance concepts
def is_professional_performance_term(text):
    """Check if text contains professional performance terminology"""
    text_lower = text.lower()
    performance_keywords = get_professional_performance_keywords()
    
    for keyword in performance_keywords:
        if keyword.lower() in text_lower:
            return True
    
    return False

# Get detailed information about performance concepts
def get_performance_concept_info(concept):
    """Get detailed information about a performance concept"""
    concept_lower = concept.lower()
    
    for section_name, section in PROFESSIONAL_PERFORMANCE_KNOWLEDGE.items():
        for category_name, category in section["concepts"].items():
            for concept_name, description in category.items():
                if concept_lower in concept_name.lower() or concept_lower in description.lower():
                    return {
                        "section": section_name,
                        "category": category_name,
                        "concept": concept_name,
                        "description": description,
                        "context": section["description"]
                    }
    
    return None

# Get related performance techniques
def get_related_performance_techniques(primary_concept):
    """Get performance techniques related to a primary concept"""
    related = []
    primary_lower = primary_concept.lower()
    
    # Search for related concepts across all sections
    for section_name, section in PROFESSIONAL_PERFORMANCE_KNOWLEDGE.items():
        for category_name, category in section["concepts"].items():
            for concept_name, description in category.items():
                if primary_lower in description.lower() or any(word in concept_name.lower() for word in primary_lower.split()):
                    related.append({
                        "technique": concept_name,
                        "description": description,
                        "category": category_name
                    })
    
    return related[:5]  # Limit to 5 most relevant

# Performance skill assessment
def assess_performance_skill_level(topics_known):
    """Assess performance skill level based on known topics"""
    skill_levels = {
        "beginner": 0,
        "intermediate": 0, 
        "advanced": 0,
        "professional": 0
    }
    
    # Simple assessment based on topic complexity
    for topic in topics_known:
        topic_lower = topic.lower()
        if any(word in topic_lower for word in ["basic", "simple", "fundamental"]):
            skill_levels["beginner"] += 1
        elif any(word in topic_lower for word in ["intermediate", "complex"]):
            skill_levels["intermediate"] += 1
        elif any(word in topic_lower for word in ["advanced", "sophisticated"]):
            skill_levels["advanced"] += 1
        elif any(word in topic_lower for word in ["professional", "mastery", "expert"]):
            skill_levels["professional"] += 1
    
    # Return the level with highest score
    return max(skill_levels.items(), key=lambda x: x[1])[0] 